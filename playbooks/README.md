# Playbooks Directory

This directory contains AI-generated playbooks distilled from successful agent task completions. These playbooks serve as reusable guides for common tasks and procedures.

## üéØ Purpose

Playbooks are automatically generated by the Memory Consolidator service, which:
1. Queries Qdrant for successful task completions
2. Sends logs to the LLM with a specialized "Distillation" prompt
3. Creates step-by-step Markdown playbooks
4. Automatically commits and pushes them to this repository

## üìã How Playbooks Are Generated

### The Distillation Process

1. **Memory Query**: The Memory Consolidator queries the `episodic_memory` namespace in Qdrant
2. **Success Filtering**: Only successful task completions are selected for playbook generation
3. **Pattern Grouping**: Similar tasks are grouped together by pattern
4. **LLM Distillation**: Logs are sent to the LLM with this prompt:
   ```
   Analyze these agent task logs and create a comprehensive, 
   step-by-step Markdown Playbook for this task type.
   
   Requirements:
   1. Create a clear, actionable playbook with numbered steps
   2. Extract best practices from successful completions
   3. Document common pitfalls from failures
   4. Include prerequisites and required tools
   5. Format as clean Markdown with proper headings
   6. Make it reusable for future agents
   ```
5. **Privacy Filtering**: Sensitive information is automatically redacted
6. **Git Push**: Playbooks are automatically committed and pushed to this repository

## üìÅ Playbook Structure

Each playbook includes:

### Header
- **Title**: Descriptive name of the task
- **Generation Metadata**: When and from how many memories it was generated
- **Success Rate**: Percentage of successful vs failed attempts

### Content Sections

1. **Prerequisites**
   - Required tools and permissions
   - System requirements
   - Pre-conditions

2. **Step-by-Step Procedures**
   - Numbered, actionable steps
   - Command examples
   - Expected outputs

3. **Best Practices**
   - Patterns from successful completions
   - Optimization tips
   - Recommended approaches

4. **Common Pitfalls**
   - Lessons learned from failures
   - What to avoid
   - Troubleshooting tips

5. **Success Indicators**
   - How to verify success
   - Expected outcomes
   - Validation steps

## üîí Privacy & Security

### Automatic Privacy Filtering

All playbooks are automatically filtered to remove:
- **IP Addresses** ‚Üí `[REDACTED_IP]`
- **Usernames** ‚Üí `[REDACTED_USER]`
- **Email Addresses** ‚Üí `[REDACTED_EMAIL]`
- **File Paths with Usernames** ‚Üí `[REDACTED_PATH]`
- **Internal Server Names** ‚Üí `[REDACTED_SERVER]`

### Privacy Filter Control

Privacy filtering is enabled by default. To disable:
```bash
export PLAYBOOK_PRIVACY_FILTER=false
```

## üìö Using Playbooks

### For Agents

Agents can reference playbooks when:
- Learning how to perform new tasks
- Following established procedures
- Avoiding common mistakes
- Understanding best practices

### For Operators

Operators can:
- Review playbooks to understand agent capabilities
- Use playbooks as documentation
- Improve playbooks by updating the source tasks
- Share playbooks across the network

## üîÑ Playbook Lifecycle

1. **Generation**: Created automatically from successful task completions
2. **Storage**: Saved to `playbooks/{pattern}.md`
3. **Sharing**: Pushed to this repository for global access
4. **Evolution**: Updated as more successful completions are recorded
5. **Refinement**: Improved over time with more examples

## üìä Playbook Statistics

Each playbook includes:
- **Total Attempts**: Number of times this task was attempted
- **Success Rate**: Percentage of successful completions
- **Success Count**: Number of successful attempts
- **Failure Count**: Number of failed attempts
- **Generation Date**: When the playbook was created

## üöÄ Example Playbook Topics

Playbooks are generated for various task patterns:

- **Service Management**: Starting, stopping, restarting services
- **Log Analysis**: Parsing and analyzing log files
- **Configuration Updates**: Modifying system configurations
- **Network Diagnostics**: Troubleshooting network issues
- **Security Monitoring**: Detecting and responding to threats
- **Data Processing**: Analyzing and transforming data

## üîç Finding Playbooks

Playbooks are organized by task pattern. To find a playbook:
1. Look for files matching your task pattern
2. Check the playbook title and description
3. Review prerequisites and steps
4. Follow the step-by-step procedures

## üí° Best Practices

### For Playbook Generation
- Focus on successful completions
- Include context and rationale
- Document edge cases
- Provide troubleshooting guidance

### For Playbook Usage
- Review prerequisites before starting
- Follow steps in order
- Verify success indicators
- Report issues for playbook improvement

## üîÑ Continuous Improvement

Playbooks evolve as:
- More successful completions are recorded
- New patterns are identified
- Best practices are refined
- Common pitfalls are discovered

The Memory Consolidator runs every 24 hours (configurable) to:
- Generate new playbooks
- Update existing playbooks
- Remove outdated playbooks

## üìù Playbook Format Example

```markdown
# Playbook: Service Health Check

*AI-generated on 2024-01-15 10:30:00 UTC from 47 episodic memories*

- Success rate: 89.4%
- Generated from 42 successful and 5 failed attempts

---

## Prerequisites

- Access to `manage_service` tool
- Permission to read service logs
- System inspection capabilities

## Step-by-Step Procedure

1. **Check Service Status**
   - Use `manage_service status {service_name}`
   - Verify service is running

2. **Review Recent Logs**
   - Use `get_logs service={service_name}`
   - Look for errors or warnings

[... additional steps ...]

## Best Practices

- Check logs before restarting services
- Verify dependencies are running
- Document all actions taken

## Common Pitfalls

- Not checking dependencies first
- Restarting during peak usage
- Missing error messages in logs
```

---

**Directory**: `playbooks/`  
**Generation**: Automatic via Memory Consolidator  
**Privacy**: Automatically filtered before push
